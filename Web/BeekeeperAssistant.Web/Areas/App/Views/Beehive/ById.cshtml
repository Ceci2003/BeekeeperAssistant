@model BeekeeperAssistant.Web.ViewModels.Beehives.ByIdBeehiveViewModel
@using BeekeeperAssistant.Data.Models
@using BeekeeperAssistant.Web.ViewModels.Shared

@{
    this.ViewData["Title"] = "Информация за кошер - №" + Model.Number;
    Dictionary<string, string> powerClasses = new Dictionary<string, string>();
    powerClasses.Add("weak", "td-weak");
    powerClasses.Add("medium", "td-medium");
    powerClasses.Add("strong", "td-strong");
    string activeClass = "active";
    string block = "block";
    string none = "none";
    string[] yesNo = new string[] { "Не", "Да" };
    var onlyReadMsg = "нямате достъп";

    string flagTypeClass = "Red";
    if (Model.HasFlag)
    {
        @switch (Model.FlagViewModel.FlagType)
        {
            case MarkFlagType.Orange:
                flagTypeClass = "Orange";
                break;
            case MarkFlagType.Green:
                flagTypeClass = "Green";
                break;
        }
    }

    string website = $"{this.Context.Request.Scheme}://{this.Context.Request.Host}{this.Context.Request.Path}";

    var navigation = new Dictionary<string, string>();
    navigation.Add("Табло", "/App");

    var title = "";
    if (!string.IsNullOrEmpty(Model.ApiaryNumber))
    {
        title = Model.ApiaryNumber;
    }
    else
    {
        title = Model.ApiaryName;
    }

    navigation.Add(title, $"/App/Apiary/ById/{Model.ApiaryId}");
    navigation.Add(ViewData["Title"].ToString(), null);

    var breadcrumbNav = new BreadcrumbModel
    {
        Navigation = navigation,
    };
}

<partial model="@breadcrumbNav" name="_BreadcrumbPartial" />

<h1 class="tab-title title-1">Информация за кошер - №@Model.Number</h1>
<div class="tab beehive">
    <a class="tablinks active" asp-controller="Beehive" asp-action="ById" asp-route-id="@Model.Id">
        <i class="fas fa-archive"></i>
        <span class="text">
            Кошер №@Model.Number
        </span>
    </a>
    <a class="tablinks" asp-controller="Queen" asp-action="ByBeehiveId" asp-route-id="@Model.Id">
        <i class="fas fa-crown"></i>
        <span class="text">
            Майка
        </span>
    </a>
    <a class="tablinks" asp-controller="Inspection" asp-action="AllByBeehiveId" asp-route-id="@Model.Id">
        <i class="far fa-calendar-check"></i>
        <span class="text">
            Прегледи
        </span>
    </a>
    <a class="tablinks " asp-controller="Treatment" asp-action="AllByBeehiveId" asp-route-id="@Model.Id">
        <i class="fas fa-notes-medical"></i>
        <span class="text">
            Третирания
        </span>
    </a>
    <a class="tablinks" asp-controller="Harvest" asp-action="AllByBeehiveId" asp-route-id="@Model.Id">
        <i class="fas fa-box"></i>
        <span class="text">
            Добиви
        </span>
    </a>
    <a class="tablinks" asp-controller="BeehiveNote" asp-action="AllByBeehiveId" asp-route-id="@Model.Id">
        <i class="fas fa-sticky-note"></i>
        <span class="text">
            Бележки
        </span>
    </a>
    <a class="tablinks" asp-controller="BeehiveDiary" asp-action="ByBeehiveId" asp-route-id="@Model.Id">
        <i class="fas fa-book"></i>
        <span class="text">
            Дневник
        </span>
    </a>
</div>

<div class="tabs-body">
    <partial name="_StatusMessagePartial" />
    @if (Model.HasFlag)
    {
        <div class="beehive-flag-box">
            <div class="info">
                <label class="flag-label @flagTypeClass">
                    <i class="fas fa-flag"></i>
                </label>
                <div class="controls">
                    <a class="edit" asp-controller="BeehiveMarkFlag" asp-action="Edit"
                    asp-route-id="@Model.FlagViewModel.Id" asp-route-beehiveId="@Model.Id">
                        <i class="far fa-edit"></i>
                    </a>
                    <a class="delete" asp-controller="BeehiveMarkFlag" asp-action="Delete"
                    asp-route-id="@Model.FlagViewModel.Id" asp-route-beehiveId="@Model.Id">
                        <i class="far fa-trash-alt"></i>
                    </a>
                </div>
            </div>
            <p>
                @Model.FlagViewModel.Content
            </p>
        </div>
    }
    <div class="page-controls intab @if(!Model.HasFlag){@("both-sides")} else{@("one")}">
        @if (!Model.HasFlag)
        {
            <div class="beehive-flag">
                <div class="choose-mark">
                    Маркирай кошера:
                    <div class="flags">
                        <a class="red" asp-controller="BeehiveMarkFlag" asp-action="Create" asp-route-id="@Model.Id"
                        asp-route-markFlagType="red">
                            <i class="fas fa-flag"></i>
                        </a>
                        <a class="orange" asp-controller="BeehiveMarkFlag" asp-action="Create" asp-route-id="@Model.Id"
                        asp-route-markFlagType="orange">
                            <i class="fas fa-flag"></i>
                        </a>
                        <a class="green" asp-controller="BeehiveMarkFlag" asp-action="Create" asp-route-id="@Model.Id"
                        asp-route-markFlagType="green">
                            <i class="fas fa-flag"></i>
                        </a>
                    </div>
                </div>
            </div>
        }
        <a class="btn apiary" asp-controller="Beehive" asp-action="SelectApiaryToMoveBeehive" asp-route-id="@Model.Id">
            <i class="fas fa-people-carry"></i>
            Премести в пчелин
        </a>
    </div>
    <div id="Beehive" class="tabcontent">
        <div class="data-view">
            <div class="qr-code">
                <a class="qr-code-print" href="javascript:printQRCode();">
                    <i class="fas fa-print"></i>
                    отпечатай кода
                </a>
                <img id="qr-code-img" src="https://api.qrserver.com/v1/create-qr-code/?data=@website&size=255x255"
                    alt="BeehiveQrCode" width="250" height="250">
            </div>
            <div class="apiary-info">
                <table>
                    <tbody>
                        <tr>
                            <th scope="row">Номер:</th>
                            <td id="beehive-num">
                                <strong>
                                    @Model.Number
                                </strong>
                            </td>
                        </tr>
                        <tr>
                            <th scope="row">Пчелин:</th>
                            <td class="beehive-apiary-num">
                                <a class="tablinks active" asp-controller="Apiary" asp-action="ById"
                                   asp-route-id="@Model.ApiaryId">
                                    <strong>
                                        @if (!string.IsNullOrEmpty(Model.ApiaryNumber))
                                        {
                                            @Model.ApiaryNumber
                                        }
                                        else
                                        {
                                            @Model.ApiaryName
                                        }
                                    </strong>
                                </a>
                            </td>
                        </tr>
                        <tr>
                            <th scope="row">Сила:</th>
                            <td class="@powerClasses[Model.BeehivePower.ToString().ToLower()]">
                                <strong>@Html.DisplayFor(x => Model.BeehivePower)</strong>
                            </td>
                        </tr>
                        <tr>
                            <th scope="row">Система:</th>
                            <td>@Html.DisplayFor(x => Model.BeehiveSystem)</td>
                        </tr>
                        <tr>
                            <th scope="row">Вид:</th>
                            <td>@Html.DisplayFor(x => Model.BeehiveType)</td>
                        </tr>
                        <tr>
                            <th scope="row">Създаден на:</th>
                            <td>
                                <time datetime="@Model.Date.ToString("O")"></time>
                            </td>
                        </tr>
                        <tr>
                            <th scope="row">Подвижен:</th>
                            @if (Model.IsItMovable)
                            {
                                <td><b>Да</b></td>
                            }
                            else
                            {
                                <td>Не</td>
                            }
                        </tr>
                        <tr>
                            <th scope="row">Апарат за майки:</th>
                            @if (Model.HasDevice)
                            {
                                <td><b>Поставен</b></td>
                            }
                            else
                            {
                                <td>няма</td>
                            }
                        </tr>
                        <tr>
                            <th scope="row">Решетка за прополис:</th>
                            @if (Model.HasPolenCatcher)
                            {
                                <td><b>Поставена</b></td>
                            }
                            else
                            {
                                <td>няма</td>
                            }
                        </tr>
                        <tr>
                            <th scope="row">Прашецоуловител:</th>
                            @if (Model.HasPropolisCatcher)
                            {
                                <td><b>Поставен</b></td>
                            }
                            else
                            {
                                <td>няма</td>
                            }
                        </tr>
                    </tbody>
                </table>
                <div class="data-edit beehive-info">
                    @if (Model.BeehiveAccess == Access.ReadWrite)
                    {
                        <a class="btn edit" asp-controller="Beehive" asp-action="Edit"
                        asp-route-id="@Model.Id">Редактирай</a>
                        <form asp-controller="Beehive" asp-action="Delete" asp-route-id="@Model.Id">
                            <input class="btn delete" type="submit" value="Изтрий" />
                        </form>
                    }
                    else
                    {
                        @onlyReadMsg
                    }
                </div>
            </div>
        </div>
    </div>
</div>
